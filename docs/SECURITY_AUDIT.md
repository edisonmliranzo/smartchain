# ğŸ”’ SmartChain Security Audit Report

**Generated:** 2026-01-01
**Auditor:** Automated Security Scan

---

## ğŸ“Š Executive Summary

| Category | Status | Issues Found |
|----------|--------|--------------|
| **Private Keys** | âš ï¸ MEDIUM | 4 hardcoded in scripts |
| **CORS Policy** | âš ï¸ MEDIUM | Permissive (allows all) |
| **Input Validation** | âœ… OK | Standard validation |
| **Dependencies** | âš ï¸ REVIEW | Should audit npm packages |
| **Authentication** | âš ï¸ N/A | No auth on RPC (by design) |
| **Eval Usage** | âœ… OK | No eval() found |

---

## ğŸ”´ Critical Issues

### 1. Hardcoded Private Keys in Scripts

**Files affected:**

- `scripts/deploy_graffiti.ts` (line 8)
- `scripts/deploy_graffiti_direct.ts` (line 8)
- `scripts/fund_wallet.ts` (line 6)
- `README.md` (lines 125, 149, 169)

**Risk:** Anyone can use these keys to control funds
**Recommendation:** Replace with environment variables

### 2. Private Keys in README

**File:** `README.md`
**Risk:** Documentation contains full private keys
**Recommendation:** Replace with placeholders or remove

---

## ğŸŸ  Medium Issues

### 3. CORS Policy Too Permissive

**File:** `src/api/rpc.ts` (line 54)
**Current:** `app.use(cors())` - Allows ALL origins
**Risk:** Cross-origin requests from any website
**Recommendation:** Configure with specific allowed origins

```typescript
app.use(cors({
  origin: ['https://smartchain.fun', 'https://smartchain-testnet.web.app'],
  methods: ['GET', 'POST']
}));
```

### 4. Faucet Rate Limiting

**Current:** One-time per address (good!)
**Potential bypass:** Users can create unlimited addresses
**Recommendation:** Add additional rate limiting:

- IP-based limiting
- Time-based cooldowns
- CAPTCHA integration

### 5. No Request Logging Authentication

**File:** `src/api/rpc.ts`
**Issue:** All RPC requests are logged without sanitization
**Risk:** Sensitive data in logs
**Recommendation:** Sanitize logged data

---

## ğŸŸ¡ Low Issues

### 6. Development Accounts Display

**Files:** `src/index.ts`, `src/testnet.ts`
**Issue:** Private keys shown in console output
**Recommendation:** Only show in development mode

### 7. No Rate Limiting on RPC

**Issue:** No protection against RPC spam/DoS
**Recommendation:** Add express-rate-limit

### 8. No Input Length Validation

**Issue:** Contract data could be very large
**Recommendation:** Add max input size limits

---

## âœ… Security Features Present

1. âœ… **Faucet Rate Limiting** - One per address, persisted
2. âœ… **Block Signature Verification** - P2P network validates
3. âœ… **SSL/HTTPS on Production** - All endpoints encrypted
4. âœ… **Firewall (UFW)** - Only required ports open
5. âœ… **Environment Variables** - Config supports .env
6. âœ… **Gitignore for Secrets** - Wallet files excluded

---

## ğŸ”§ Recommended Actions

### Immediate (Do Now)

1. [ ] Fix hardcoded keys in scripts
2. [ ] Update README to remove keys
3. [ ] Restrict CORS to production domains

### Short-term (This Week)

4. [ ] Add express-rate-limit to RPC
2. [ ] Implement IP-based faucet limiting
3. [ ] Add npm audit to CI/CD

### Long-term (This Month)

7. [ ] Add CAPTCHA to faucet
2. [ ] Implement request logging sanitization
3. [ ] Add automated security scanning
4. [ ] Consider DDoS protection (Cloudflare)

---

## ğŸ“ Files That Need Attention

| File | Priority | Issue |
|------|----------|-------|
| `scripts/deploy_graffiti.ts` | ğŸ”´ HIGH | Hardcoded key |
| `scripts/deploy_graffiti_direct.ts` | ğŸ”´ HIGH | Hardcoded key |
| `scripts/fund_wallet.ts` | ğŸ”´ HIGH | Hardcoded key |
| `README.md` | ğŸ”´ HIGH | Contains keys |
| `src/api/rpc.ts` | ğŸŸ  MEDIUM | CORS too open |

---

## ğŸŒ Network Security Checklist

### VPS Hardening

- [ ] SSH key-only authentication
- [ ] Disable root SSH login
- [ ] Automatic security updates
- [ ] Fail2ban installed
- [ ] UFW configured

### Application Security

- [ ] SSL certificates valid
- [ ] HTTPS enforced
- [ ] Rate limiting enabled
- [ ] Logs monitored

---

*Report generated by SmartChain Security Scanner*
